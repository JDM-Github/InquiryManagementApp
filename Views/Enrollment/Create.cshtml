@inject InquiryManagementApp.Service.EnrollmentScheduleService EnrollmentSchedule
@model InquiryManagementApp.Models.Enrollment
@{

}

<div class="container my-5 py-5 min-vh-100">
    <div class="modal fade" id="enrollmentStepsModal" tabindex="-1" aria-labelledby="enrollmentStepsLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="enrollmentStepsLabel">Enrollment Steps</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <ol class="list-group list-group-numbered">
                        <li class="list-group-item">Click the <b>Enroll Now</b> button.</li>
                        <li class="list-group-item">Complete the form with the required information.</li>

                        <li class="list-group-item">After sending enrollment form, a message will indicate that your
                            application is awaiting approval from the registrar. Please allow some time for this
                            process.</li>
                        <li class="list-group-item">An email will be send to your email, this is too proceed with online
                            payment <b>Proceed Payment</b>.</li>
                        <li class="list-group-item">
                            An auto-generated temporary account will be created:
                            <ul>

                                <li><b>Username:</b> temp[firstname][enrollment_number][school_year][surname]</li>

                                <li><b>Password:</b> [random_generated_password]</li>
                            </ul>
                        </li>
                        <li class="list-group-item">Once the registrar approves your documents, proceed with online
                            payment by logging into your temporary account and clicking <b>Proceed Payment</b>.</li>
                        <li class="list-group-item">After payment and approval of registrar, a certificate confirming your enrollment will be displayed on your account.</li>
                        <li class="list-group-item">
                            After completing the enrollment process, your permanent student account will be created:
                            <ul>

                                <li><b>Username:</b> temp[firstname][student_id][surname]</li>

                                <li><b>Password:</b> [random_generated_password]</li>
                            </ul>
                            You can then view your subjects and finalize your enrollment.
                        </li>
                        <li class="list-group-item">Hardcopy documents will need to be submitted at the school.</li>
                    </ol>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>


    <div class="modal fade" id="programsOfferedModal" tabindex="-1" aria-labelledby="programsOfferedLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="programsOfferedLabel">Programs We Offer</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <h6 class="text-primary">Available Programs</h6>
                    <ul class="list-group">
                        <li class="list-group-item">NURSERY</li>
                        <li class="list-group-item">KINDER</li>
                        <li class="list-group-item">ELEMENTARY (GRADE 1 - GRADE 6)</li>
                        <li class="list-group-item">JUNIOR HIGH SCHOOL (GRADE 7 - GRADE 10)</li>
                        <li class="list-group-item">SENIOR HIGH SCHOOL</li>
                        <ul>
                            <li>GRADE 11 ABM (1ST & 2ND SEM)</li>
                            <li>GRADE 11 HUMSS (1ST & 2ND SEM)</li>
                            <li>GRADE 12 ABM (1ST & 2ND SEM)</li>
                            <li>GRADE 12 HUMSS (1ST & 2ND SEM)</li>
                        </ul>
                    </ul>
                    <h6 class="text-primary mt-3">Modes of Payment</h6>
                    <ul class="list-group">
                        <li class="list-group-item">CASH</li>
                        <li class="list-group-item">QUARTERLY</li>
                        <li class="list-group-item">MONTHLY</li>
                        <li class="list-group-item">INITIAL 5 PROMO</li>
                    </ul>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>


    <!-- Enrollment Form Section -->
    <div class="row">
        <div class="col-lg-8 mx-auto">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white text-center">
                    <h3><strong>ENROLLMENT FORM</strong></h3>
                </div>
                <div class="card-body">
                    <form id="enrollmentForm" asp-action="Create" enctype="multipart/form-data" novalidate>

                        <div id="step1" class="step-section">
                            <div class="row mb-3">
                                <div class="col-4">
                                    <label asp-for="Surname" class="form-label fw-bold">Surname<span
                                            class="text-danger">*</span></label>
                                    <input asp-for="Surname" class="form-control rounded-3 border border-primary"
                                        placeholder="Enter surname" required />
                                    <span asp-validation-for="Surname" class="text-danger"></span>
                                </div>
                                <div class="col-4">
                                    <label asp-for="Firstname" class="form-label fw-bold">First Name<span
                                            class="text-danger">*</span></label>
                                    <input asp-for="Firstname" class="form-control rounded-3 border border-primary"
                                        placeholder="Enter first name" required />
                                    <span asp-validation-for="Firstname" class="text-danger"></span>
                                </div>
                                <div class="col-4">
                                    <label asp-for="Middlename" class="form-label fw-bold">Middle Name</label>
                                    <input asp-for="Middlename" class="form-control rounded-3 border border-primary"
                                        placeholder="Enter your middle name" />
                                    <span asp-validation-for="Middlename" class="text-danger"></span>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label class="form-label fw-bold">Gender<span class="text-danger">*</span></label>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input rounded-3 border border-primary" type="radio"
                                        asp-for="Gender" value="Male" />
                                    <label class="form-check-label">Male</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input rounded-3 border border-primary" type="radio"
                                        asp-for="Gender" value="Female" />
                                    <label class="form-check-label">Female</label>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label asp-for="DateOfBirth" class="form-label fw-bold">Date of Birth<span
                                        class="text-danger">*</span></label>
                                <input asp-for="DateOfBirth" type="date"
                                    class="form-control rounded-3 border border-primary" id="dateOfBirth" required />
                                <span asp-validation-for="DateOfBirth" class="text-danger"></span>
                            </div>

                            <div class="mb-3">
                                <label asp-for="Age" class="form-label fw-bold">Age<span
                                        class="text-danger">*</span></label>
                                <input asp-for="Age" type="number" class="form-control rounded-3 border border-primary"
                                    id="age" placeholder="Enter your age" readonly />
                                <span asp-validation-for="Age" class="text-danger"></span>
                            </div>

                            <div class="mb-3">
                                <label asp-for="GradeLevel" class="form-label fw-bold">Grade Level<span
                                        class="text-danger">*</span></label>
                                <select asp-for="GradeLevel" class="form-control rounded-3 border border-primary"
                                    required>
                                    <option value="NURSERY">NURSERY</option>
                                    <option value="KINDER">KINDER</option>
                                    <option value="ELEMENTARY">ELEMENTARY GRADE 1</option>
                                    <option value="ELEMENTARY">ELEMENTARY GRADE 2</option>
                                    <option value="ELEMENTARY">ELEMENTARY GRADE 3</option>
                                    <option value="ELEMENTARY">ELEMENTARY GRADE 4</option>
                                    <option value="ELEMENTARY">ELEMENTARY GRADE 5</option>
                                    <option value="ELEMENTARY">ELEMENTARY GRADE 6</option>
                                    <option value="JUNIOR HIGH SCHOOL">JUNIOR HIGH SCHOOL GRADE 7</option>
                                    <option value="JUNIOR HIGH SCHOOL">JUNIOR HIGH SCHOOL GRADE 8</option>
                                    <option value="JUNIOR HIGH SCHOOL">JUNIOR HIGH SCHOOL GRADE 9</option>
                                    <option value="JUNIOR HIGH SCHOOL">JUNIOR HIGH SCHOOL GRADE 10</option>

                                    <option value="SENIOR HIGH SCHOOL 11 ABM (1ST SEM)">SENIOR HIGH SCHOOL 11 ABM (1ST
                                        SEM)</option>
                                    <option value="SENIOR HIGH SCHOOL 11 ABM (2ND SEM)">SENIOR HIGH SCHOOL 11 ABM (2ND
                                        SEM)</option>

                                    <option value="SENIOR HIGH SCHOOL 11 HUMSS (1ST SEM)">SENIOR HIGH SCHOOL 11 HUMSS
                                        (1ST SEM)</option>
                                    <option value="SENIOR HIGH SCHOOL 11 HUMSS (2ND SEM)">SENIOR HIGH SCHOOL 11 HUMSS
                                        (2ND SEM)</option>


                                    <option value="SENIOR HIGH SCHOOL 12 ABM (1ST SEM)">SENIOR HIGH SCHOOL 12 ABM (1ST
                                        SEM)</option>
                                    <option value="SENIOR HIGH SCHOOL 12 ABM (2ND SEM)">SENIOR HIGH SCHOOL 12 ABM (2ND
                                        SEM)</option>

                                    <option value="SENIOR HIGH SCHOOL 12 HUMSS (1ST SEM)">SENIOR HIGH SCHOOL 12 HUMSS
                                        (1ST SEM)</option>
                                    <option value="SENIOR HIGH SCHOOL 12 HUMSS (2ND SEM)">SENIOR HIGH SCHOOL 12 HUMSS
                                        (2ND SEM)</option>
                                </select>
                                <span asp-validation-for="GradeLevel" class="text-danger"></span>
                            </div>


                            <div class="mb-3">
                                <label for="Subject" class="form-label fw-bold p-2">Subject<span
                                        class="text-danger">*</span></label>
                                <div class="subject-dropdown-container rounded-3 border border-primary">
                                    <div id="Subject" class="form-control subject-dropdown">
                                        <span class="dropdown-placeholder">Subjects</span>
                                        <span class="dropdown-selected-subjects"></span>
                                    </div>
                                    <div class="subject-dropdown-list"
                                        style="display: none; border: 1px solid #ccc; padding: 10px; max-height: 200px; overflow-y: auto;">
                                    </div>
                                </div>
                                <input type="hidden" id="SelectedSubjects" name="SelectedSubjects" value="" />
                            </div>

                            <div class="mb-3">
                                <label asp-for="Email" class="form-label fw-bold">Email<span
                                        class="text-danger">*</span></label>
                                <input asp-for="Email" type="email" class="form-control rounded-3 border border-primary"
                                    placeholder="Enter your email" />
                                <span asp-validation-for="Email" class="text-danger"></span>
                            </div>

                            <div class="mb-3">
                                <label asp-for="Address" class="form-label fw-bold">Address<span
                                        class="text-danger">*</span></label>
                                <textarea asp-for="Address" class="form-control rounded-3 border border-primary"
                                    placeholder="Enter your address" rows="3" required></textarea>
                                <span asp-validation-for="Address" class="text-danger"></span>
                            </div>

                            <div class="mb-3">
                                <label asp-for="LRN" class="form-label fw-bold">LRN (Learner Reference Number)</label>
                                <input asp-for="LRN" class="form-control rounded-3 border border-primary"
                                    placeholder="Enter your LRN" />
                            </div>
                        </div>

                        <div id="step3" class="step-section" style="display:none;">
                            <div class="mb-3">
                                <label asp-for="FatherLastName" class="form-label fw-bold">Father's Last
                                    Name<span class="text-danger">*</span></label>
                                <input asp-for="FatherLastName" class="form-control rounded-3 border border-primary"
                                    placeholder="Enter Father's Last Name" required />
                                <span asp-validation-for="FatherLastName" class="text-danger"></span>
                            </div>
                            <div class="mb-3">
                                <label asp-for="FatherFirstName" class="form-label fw-bold">Father's First
                                    Name<span class="text-danger">*</span></label>
                                <input asp-for="FatherFirstName" class="form-control rounded-3 border border-primary"
                                    placeholder="Enter Father's First Name" required />
                                <span asp-validation-for="FatherFirstName" class="text-danger"></span>
                            </div>
                            <div class="mb-3">
                                <label asp-for="FatherOccupation" class="form-label fw-bold">Father's
                                    Occupation<span class="text-danger">*</span></label>
                                <input asp-for="FatherOccupation" class="form-control rounded-3 border border-primary"
                                    placeholder="Enter Father's Occupation" required />
                                <span asp-validation-for="FatherOccupation" class="text-danger"></span>
                            </div>
                        </div>
                        <div id="step4" class="step-section" style="display:none;">
                            <div class="mb-3">
                                <label asp-for="MotherLastName" class="form-label fw-bold">Mother's Last
                                    Name<span class="text-danger">*</span></label>
                                <input asp-for="MotherLastName" class="form-control rounded-3 border border-primary"
                                    placeholder="Enter Mother's Last Name" required />
                                <span asp-validation-for="MotherLastName" class="text-danger"></span>
                            </div>
                            <div class="mb-3">
                                <label asp-for="MotherFirstName" class="form-label fw-bold">Mother's First
                                    Name<span class="text-danger">*</span></label>
                                <input asp-for="MotherFirstName" class="form-control rounded-3 border border-primary"
                                    placeholder="Enter Mother's First Name" required />
                                <span asp-validation-for="MotherFirstName" class="text-danger"></span>
                            </div>
                            <div class="mb-3">
                                <label asp-for="MotherOccupation" class="form-label fw-bold">Mother's
                                    Occupation<span class="text-danger">*</span></label>
                                <input asp-for="MotherOccupation" class="form-control rounded-3 border border-primary"
                                    placeholder="Enter Mother's Occupation" required />
                                <span asp-validation-for="MotherOccupation" class="text-danger"></span>
                            </div>
                            <div class="mb-3">
                                <label asp-for="MotherMaidenName" class="form-label fw-bold">Mother's Maiden
                                    Name<span class="text-danger">*</span></label>
                                <input asp-for="MotherMaidenName" class="form-control rounded-3 border border-primary"
                                    placeholder="Enter Mother's Maiden Name" />
                                <span asp-validation-for="MotherMaidenName" class="text-danger"></span>
                            </div>
                        </div>

                        <div id="step5" class="step-section" style="display:none;">
                            <div class="mb-3">
                                <label asp-for="PaymentType" class="form-label">Select Payment Type<span
                                        class="text-danger">*</span></label>
                                <select asp-for="PaymentType" class="form-select rounded-3 border border-primary" id="PaymentType"
                                    id="PaymentType" required onchange="updateCalculation()">
                                    <option value="" disabled>Select a type of payment</option>
                                    <option value="Cash">Cash</option>
                                    <option value="Quarterly">Quarterly</option>
                                    <option value="Monthly">Monthly</option>
                                    <option value="Initial5">Initial5</option>
                                </select>
                                <span asp-validation-for="PaymentType" class="text-danger"></span>
                            </div>

                            <div class="mb-3">
                                <label for="NumberOfSibling" class="form-label" asp-for="NumberOfSibling">Number
                                    of Siblings enrolled in school:<span class="text-danger">*</span></label>
                                <input type="number" class="form-control rounded-3 border border-primary"
                                    id="NumberOfSibling" asp-for="NumberOfSibling" name="NumberOfSibling" min="0"
                                    name="NumberOfSibling" min="0" value="0" oninput="updateCalculation()" />
                            </div>

                            <div class="mb-3">
                                <div class="rounded-3 border border-primary p-3">
                                    <h3>CALCULATION</h3>
                                    <span><i>- Tuition: <span id="tuition">@ViewBag.TuitionFee.ToString("C")</span></i></span><br>
                                    <span><i>- Miscellaneous: <span
                                                id="miscellaneous">@ViewBag.Miscellaneous.ToString("C")</span><br></i></span><br>
                                    <span><i id="cashDiscount">- 10% Cash discount.<br></i></span>
                                    <span><i id="earlyBird">- 10% Early bird discount.<br></i></span>
                                    <span><i id="siblingDiscount">- Sibling Discount: <span id="siblingDiscountPercentage">0%</span> (<span
                                                id="siblingDiscountAmount">P0</span>)<br></i></span>
                                    <hr>
                                    <span>Total Discount: <span id="totalDiscount"></span></span><br>
                                    <span>Final Amount: <span id="finalAmount"></span></span><br>
                                    <hr>
                                    <span>Payment Breakdown: <span id="breakDown"></span></span>
                                    <ul id="paymentBreakdown" class="list-unstyled">
                                    </ul>
                                </div>
                            </div>
                        </div>


                        <div class="d-flex justify-content-between">
                            <button type="button" class="btn btn-secondary" id="prevBtn">Previous</button>
                            <button type="button" class="btn btn-primary" id="nextBtn">Next</button>
                            <button type="submit" class="btn btn-primary" id="submitBtn" style="display:none;">
                                Enroll Now</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

</div>


<script>
    function updateCalculation() {
        const tuition = @ViewBag.TuitionFee;
        const miscellaneous = @ViewBag.Miscellaneous;
        const totalFee = tuition + miscellaneous;

        const paymentType = document.getElementById("PaymentType").value;
        const isCashPayment = paymentType === "Cash";
        const numberOfSiblings = parseInt(document.getElementById("NumberOfSibling").value) || 0;

        const siblingDiscountRate = Math.min(numberOfSiblings * 0.1, 0.5);
        const siblingDiscount = tuition * siblingDiscountRate;

        const isEnrollmentOpen = @EnrollmentSchedule.IsEnrollmentOpen().ToString().ToLower();
        const earlyBirdDiscount = isEnrollmentOpen ? tuition * 0.1 : 0;
        const cashDiscount = isCashPayment ? tuition * 0.1 : 0;

        const totalDiscount = siblingDiscount + earlyBirdDiscount + cashDiscount;
        const discountedTuition = tuition - totalDiscount;
        const finalAmount = discountedTuition + miscellaneous;

        document.getElementById("siblingDiscountPercentage").innerText = `${(siblingDiscountRate * 100).toFixed(0)}%`;
        document.getElementById("siblingDiscountAmount").innerText = `₱${siblingDiscount.toFixed(2)}`;
        document.getElementById("totalDiscount").innerText = `₱${totalDiscount.toFixed(2)}`;
        document.getElementById("finalAmount").innerText = `₱${finalAmount.toFixed(2)}`;

        document.getElementById("siblingDiscount").style.display = "block";
        document.getElementById("earlyBird").style.display = isEnrollmentOpen ? "block" : "none";
        document.getElementById("cashDiscount").style.display = isCashPayment ? "block" : "none";

        const paymentBreakdown = document.getElementById("paymentBreakdown");
        paymentBreakdown.innerHTML = ""; 

        if (paymentType === "Monthly") {
            paymentBreakdown.innerHTML += `<li><i>First Payment ₱${miscellaneous + discountedTuition / 10}</i></li>`;
            const monthlyPayment = discountedTuition / 10; // Sep to May = 9 months
            const months = ["September", "October", "November", "December", "January", "February", "March", "April", "May"];
            months.forEach(month => {
                paymentBreakdown.innerHTML += `<li><i>Pay ₱${monthlyPayment.toFixed(2)} in ${month}</i></li>`;
            });
        } else if (paymentType === "Quarterly") {
            paymentBreakdown.innerHTML += `<li><i>First Payment ₱${miscellaneous + discountedTuition / 4}</i></li>`;
            const quarterlyPayment = discountedTuition / 4; // 3 quarters
            const quarters = ["October", "January", "April"];
            quarters.forEach(quarter => {
                paymentBreakdown.innerHTML += `<li><i>Pay ₱${quarterlyPayment.toFixed(2)} in ${quarter}</i></li>`;
            });
        } else if (paymentType === "Initial5") {
            paymentBreakdown.innerHTML += `<li><i>First Payment ₱${5000}</i></li>`;
            const initial5Payment = (totalFee - 5000) / 10;
            const months = ["August", "September", "October", "November", "December", "January", "February", "March", "April", "May"];
            months.forEach(month => {
                paymentBreakdown.innerHTML += `<li><i>Pay ₱${initial5Payment.toFixed(2)} in ${month}</i></li>`;
            });

            document.getElementById("earlyBird").style.display = "none";
            document.getElementById("cashDiscount").style.display = "none";
            document.getElementById("siblingDiscount").style.display = "none";
        } else {
            paymentBreakdown.innerHTML = `<li><i>Pay ₱${finalAmount.toFixed(2)}.</i></li>`;
        }
    }
    function getMonthName(monthNumber) {
        const monthNames = [
            "January", "February", "March", "April", "May", "June", "July",
            "August", "September", "October", "November", "December"
        ];
        return monthNames[monthNumber - 1];
    }
    updateCalculation();

    window.addEventListener('load', () => {
        const enrollmentModal = new bootstrap.Modal(document.getElementById('enrollmentStepsModal'));
        enrollmentModal.show();

        document.getElementById('enrollmentStepsModal').addEventListener('hidden.bs.modal', () => {
            const programsOfferedModal = new bootstrap.Modal(document.getElementById('programsOfferedModal'));
            programsOfferedModal.show();
        });
    });


    document.addEventListener('DOMContentLoaded', async function () {
    @* const documentRequirements = document.getElementById('documentRequirements'); *@
        const uploadedFilesList = document.getElementById('uploadedFiles');
        const maxUploads = 6;

        const subjects = {
            'NURSERY': ['Cultural Arts', 'MAPE', 'Mathematics', 'Science', 'Reading and Language', 'Spelling'],
            'KINDER': ['Filipino', 'English', 'Mathematics', 'Science and Health', 'Writing', 'MAPE',],
            'ELEMENTARY': ['Math', 'Science', 'English', 'Filipino', 'AP', 'MAPEH', 'ESP', 'TLE'],
            'JUNIOR HIGH SCHOOL': ['Math', 'English', 'Science', 'Filipino', 'AP', 'MAPEH', 'Values', 'TLE'],
            'SENIOR HIGH SCHOOL 11 ABM (1ST SEM)': ['Physical Education 1', 'Statistic and Probability', '21st Century Literature from the Philippines and the World', 'Pagbasa and Pagsusuri ng ibat ibang teksto tungo sa Pananaliksik', 'Introduction to Philosophy of the Human Person', 'Oral Communication', 'Media and Information Literacy', 'Pagsusulat sa Filipino sa Piling Larangan'],
            'SENIOR HIGH SCHOOL 11 ABM (2ND SEM)': ['Physical Education 2', 'Earth and Life Science', 'Contemporary Philippines Arts in the Regions', 'Understanding Culture, Society and Politics', 'Research in Daily Life 1', 'Organization and Management', 'Fundamentals of Accountancy and Business Management 1', 'Business Math'],
            'SENIOR HIGH SCHOOL 12 ABM (1ST SEM)': ['Physical Education 3', 'General Mathematics', 'Physical Science', 'Research in Daily Life 2', 'Empowerment Technologies (ETech) ICT for Professionals Tracks', 'Applied Economics', 'Fundamentals of Accountancy and Business Management 2', 'Business Finance'],
            'SENIOR HIGH SCHOOL 12 ABM (2ND SEM)': ['Physical Education 4', 'Komonikasyon at Pananaliksik sa Kultura at Wikang Pilipino', 'Reading and Writing Skills', 'Entrepreneurship', 'Inquiries, Investigation and Immersion', 'English for Academic and Professional Purposes', 'Business Ethics and Social Responsibility', 'Business Marketing', 'Capstone/Business Enterprise Simulation'],
            'SENIOR HIGH SCHOOL 11 HUMSS (1ST SEM)': ['Physical Education 1', 'Statistic and Probability', '21st Century Literature from the Philippines and the World', 'Pagbasa and Pagsusuri ng ibat ibang teksto tungo sa Pananaliksik', 'Introduction to Philosophy of the Human Herson', 'Oral Communication', 'Media and Information Literacy', 'Pagsusulat sa Filipino sa Piling Larangan'],
            'SENIOR HIGH SCHOOL 12 HUMSS (2ND SEM)': ['Physical Education 2', 'Earth and Life Science', 'Contemporary Philippines Arts in the Regions', 'Personal Development', 'Understanding Culture, Society and Politics', 'Research in Daily Life 1', 'Discipline and Ideas in the Social Sciences', 'Creative Writing', 'Philippine Politics and Governance'],
            'SENIOR HIGH SCHOOL 11 HUMSS (1ST SEM)': ['Physical Education 3', 'General Mathematics', 'Physical Science', 'Research in Daily Life 2', 'Empowerment Technologies (ETech) ICT for Professionals Tracks', 'Introduce to World Religion and Belief Systems', 'Discipline and Ideas in the Social Sciences', 'Community Engagement Solidarity and Citizenship'],
            'SENIOR HIGH SCHOOL 12 HUMSS (2ND SEM)': ['Physical Education 4', 'Komonikasyon at Pananaliksik sa Kultura at Wikang Pilipino', 'Reading and Writing Skills', 'Entrepreneurship', 'Inquiries, Investigation and Immersion', 'English for Academic and Professional Purposes', 'Creative Nonfiction', 'Trends, Networks, and Critica; Thinking in the 21st Century Culture', 'Capstone/Culminating Program'],
        };

        async function loadTuitionFees() {
            const response = await fetch('/Fee/GetTuitionFees');
            const tuitionFees = await response.json();

            const allTuition = {};

            tuitionFees.forEach(fee => {
                allTuition[fee.level] = fee.fee;
            });
            return allTuition;
        }

        const allTuition = await loadTuitionFees();


        const gradeLevelSelect = document.getElementById('GradeLevel');
        const subjectDropdown = document.getElementById('Subject');
        const subjectDropdownList = document.querySelector('.subject-dropdown-list');
        const selectedSubjectsInput = document.getElementById('SelectedSubjects');
        const selectedSubjectsContainer = subjectDropdown.querySelector('.dropdown-selected-subjects');
        let selectedSubjects = [];

        gradeLevelSelect.addEventListener('change', function () {
            const gradeLevel = this.value;
            const subjectsList = subjects[gradeLevel] || [];
            subjectDropdownList.innerHTML = '';
            selectedSubjects = [];
            selectedSubjectsContainer.innerHTML = '';

            subjectsList.forEach(subject => {
                const subjectItem = document.createElement('div');
                subjectItem.classList.add('subject-item');
                subjectItem.style.cursor = 'pointer';
                subjectItem.style.padding = '5px';
                subjectItem.textContent = subject;

                subjectDropdownList.appendChild(subjectItem);
            });

            subjectDropdownList.style.display = subjectsList.length > 0 ? 'block' : 'none';
        });


        function toggleSubjectSelection(subject) {
            if (selectedSubjects.includes(subject)) {
                selectedSubjects = selectedSubjects.filter(s => s !== subject);
            } else {
                selectedSubjects.push(subject);
            }
            updateSelectedSubjects();
        }

        function updateSelectedSubjects() {
            selectedSubjectsContainer.innerHTML = selectedSubjects.join(', ');
            selectedSubjectsInput.value = selectedSubjects.join(',');
        }

        const gradeLevelRequirements = {
            'NURSERY': ['PSA'],
            'KINDER': ['PSA'],
            'ELEMENTARY': ['PSA', 'Form 9', 'Form 10'],
            'JUNIOR HIGH SCHOOL': ['PSA', 'Form 9', 'Form 10', 'Good Moral'],
            'SENIOR HIGH SCHOOL - ABM': ['PSA', 'Form 9', 'Form 10', 'Good Moral', 'Certificate of Completion'],
            'SENIOR HIGH SCHOOL - HUMSS': ['PSA', 'Form 9', 'Form 10', 'Good Moral', 'Certificate of Completion']
        };

    @* gradeLevelSelect.addEventListener('change', function () {
            const selectedGrade = gradeLevelSelect.value;
            const requirements = gradeLevelRequirements[selectedGrade] || [];
            documentRequirements.innerHTML = `<strong>Required Documents:</strong> ${requirements.join(', ')}`;
        }); *@


            gradeLevelSelect.dispatchEvent(new Event('change'));

        let currentStep = 1;
        function showStep(step) {
            const allSteps = document.querySelectorAll('.step-section');
            allSteps.forEach((stepElement, index) => {
                stepElement.style.display = index === step - 1 ? 'block' : 'none';
            });

            document.getElementById('prevBtn').disabled = step === 1;
            document.getElementById('nextBtn').style.display = step === allSteps.length ? 'none' : 'inline-block';
            document.getElementById('submitBtn').style.display = step === allSteps.length ? 'inline-block' : 'none';
        }

        function updateAge(instance) {
            const dob = new Date(instance.value);
            const today = new Date();

            let age = today.getFullYear() - dob.getFullYear();
            const month = today.getMonth();
            const day = today.getDate();

            if (month < dob.getMonth() || (month === dob.getMonth() && day < dob.getDate())) {
                age--;
            }
            document.getElementById('age').value = age;
        }

        document.getElementById('dateOfBirth').addEventListener('change', () => { updateAge(document.getElementById('dateOfBirth')) });
        document.getElementById('nextBtn').addEventListener('click', () => {
            if (currentStep < 5) {
                currentStep++;
                showStep(currentStep);
            }
        });
        document.getElementById('prevBtn').addEventListener('click', () => {
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
            }
        });
        showStep(currentStep);
        updateAge(document.getElementById('dateOfBirth'));
    });


</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
